[OK] Load SEAL context
Load dataset from {} /home/haochu/Desktop/project/datasets/CICIDS2017/custom/dataset_balance_splited_2_1.pickle
[OK] Init model
[OK] Connected to server
[OK] Server set this client as leader
[OK] Encypted weight, size: 32.54 MB
[OK] Send encrypted init weight to server
Round 1:
Train with 91052 samples
Epoch:  0 | train loss: 222.4045
Epoch:  1 | train loss: 125.5835
Epoch:  2 | train loss: 111.0457
Epoch:  3 | train loss: 102.9031
Epoch:  4 | train loss: 97.3358
Epoch:  5 | train loss: 92.0807
Epoch:  6 | train loss: 87.3547
Epoch:  7 | train loss: 83.9444
Epoch:  8 | train loss: 81.4434
Epoch:  9 | train loss: 79.0022
Local test
Accuracy: 0.9750
Label:  0 | precision: 0.9602 % | recall: 0.9911 % | F1: 0.9754 | support: 116901
Label:  1 | precision: 0.9908 % | recall: 0.9590 % | F1: 0.9747 | support: 117233
[OK] Encypted weight, size: 32.54 MB
[OK] Send encrypted weight to server for aggregate
[OK] Recieve model from server
Round 2:
Train with 91052 samples
Epoch:  0 | train loss: 79.1874
Epoch:  1 | train loss: 76.2952
Epoch:  2 | train loss: 73.8305
Epoch:  3 | train loss: 72.2281
Epoch:  4 | train loss: 70.5125
Epoch:  5 | train loss: 69.3352
Epoch:  6 | train loss: 67.7882
Epoch:  7 | train loss: 67.1294
Epoch:  8 | train loss: 65.4967
Epoch:  9 | train loss: 65.2593
Local test
Accuracy: 0.9771
Label:  0 | precision: 0.9591 % | recall: 0.9967 % | F1: 0.9775 | support: 116901
Label:  1 | precision: 0.9965 % | recall: 0.9576 % | F1: 0.9767 | support: 117233
[OK] Encypted weight, size: 32.54 MB
[OK] Send encrypted weight to server for aggregate
[OK] Recieve model from server
Round 3:
Train with 91051 samples
Epoch:  0 | train loss: 66.6229
Epoch:  1 | train loss: 65.1834
Epoch:  2 | train loss: 63.9123
Epoch:  3 | train loss: 63.0998
Epoch:  4 | train loss: 61.9871
Epoch:  5 | train loss: 61.5644
Epoch:  6 | train loss: 61.2348
Epoch:  7 | train loss: 60.5513
Epoch:  8 | train loss: 60.1566
Epoch:  9 | train loss: 59.3342
Local test
Accuracy: 0.9792
Label:  0 | precision: 0.9633 % | recall: 0.9962 % | F1: 0.9795 | support: 116901
Label:  1 | precision: 0.9961 % | recall: 0.9621 % | F1: 0.9788 | support: 117233
[OK] Encypted weight, size: 32.54 MB
[OK] Send encrypted weight to server for aggregate
[OK] Recieve model from server
Final test
Accuracy: 0.9824
Label:  0 | precision: 0.9773 % | recall: 0.9877 % | F1: 0.9825 | support: 116901
Label:  1 | precision: 0.9876 % | recall: 0.9771 % | F1: 0.9823 | support: 117233
